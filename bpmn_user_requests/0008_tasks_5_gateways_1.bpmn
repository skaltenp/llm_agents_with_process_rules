<?xml version="1.0" encoding="UTF-8"?>
<definitions xmlns="http://www.omg.org/spec/BPMN/20100524/MODEL" xmlns:bpmndi="http://www.omg.org/spec/BPMN/20100524/DI" xmlns:omgdc="http://www.omg.org/spec/DD/20100524/DC" xmlns:omgdi="http://www.omg.org/spec/DD/20100524/DI" xmlns:camunda="http://camunda.org/schema/1.0/bpmn" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" targetNamespace="http://bpmn.io/schema/bpmn" exporter="Camunda Modeler" exporterVersion="5.32.0">
  <collaboration id="Collaboration_1b9mwkl">
    <participant id="Participant_18ipkdm" name="LLM Agent" processRef="CheckAndUpdateIDocs" />
    <textAnnotation id="TextAnnotation_0obj7se">
      <text>Segment "E1EDKA1"</text>
    </textAnnotation>
    <textAnnotation id="TextAnnotation_1u11gvb">
      <text>Function: RFC
Parameters:
function: RFC_READ_TABLE
rfc_parameters: {'TABLE_NAME': 'ORDERS_JOIN_SUPPLIERS', 'ORDER_NUMBER': '&lt;BELNR&gt;'}</text>
    </textAnnotation>
    <association id="Association_0fc4w4a" associationDirection="None" sourceRef="ServiceTask_CheckSupplierID_9876543" targetRef="TextAnnotation_0obj7se" />
    <textAnnotation id="TextAnnotation_1savs70">
      <text>Segment "E1EDK01"</text>
    </textAnnotation>
    <association id="Association_1wppsmx" associationDirection="None" sourceRef="Activity_0iqk13w" targetRef="TextAnnotation_1savs70" />
  </collaboration>
  <process id="CheckAndUpdateIDocs" isExecutable="true">
    <startEvent id="StartEvent_IdocCheck">
      <outgoing>SequenceFlow_IdocCheck1</outgoing>
    </startEvent>
    <task id="ServiceTask_CheckSupplierID_9876543" name="Check &#39;PARTN&#39; in IDoc 9876543 and 9876547">
      <extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="idoc_id">9876543</camunda:inputParameter>
          <camunda:inputParameter name="segment">E1EDKA1</camunda:inputParameter>
          <camunda:inputParameter name="key">SUPPLIER_ID</camunda:inputParameter>
        </camunda:inputOutput>
      </extensionElements>
      <incoming>SequenceFlow_IdocCheck1</incoming>
      <outgoing>SequenceFlow_CheckGateway</outgoing>
    </task>
    <sequenceFlow id="SequenceFlow_CheckGateway" sourceRef="ServiceTask_CheckSupplierID_9876543" targetRef="ExclusiveGateway_SupplierIDCheck" />
    <sequenceFlow id="SequenceFlow_SupplierIDMissing" name="yes" sourceRef="ExclusiveGateway_SupplierIDCheck" targetRef="Activity_0iqk13w">
      <conditionExpression xsi:type="tFormalExpression">#{missingSupplier}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="SequenceFlow_SupplierIDPresent" name="no" sourceRef="ExclusiveGateway_SupplierIDCheck" targetRef="Gateway_0pj5fa2">
      <conditionExpression xsi:type="tFormalExpression">#{!missingSupplier}</conditionExpression>
    </sequenceFlow>
    <sequenceFlow id="SequenceFlow_IdocCheck1" sourceRef="StartEvent_IdocCheck" targetRef="ServiceTask_CheckSupplierID_9876543" />
    <sequenceFlow id="SequenceFlow_UpdateIDoc" sourceRef="ServiceTask_GetSupplierID_9876543" targetRef="ServiceTask_UpdateIDoc_9876543" />
    <sequenceFlow id="SequenceFlow_ReinitializeIDoc" sourceRef="ServiceTask_UpdateIDoc_9876543" targetRef="ServiceTask_ReinitializeIDoc_9876543" />
    <sequenceFlow id="Flow_1ylona2" sourceRef="ServiceTask_ReinitializeIDoc_9876543" targetRef="Gateway_0pj5fa2" />
    <sequenceFlow id="Flow_0j9jc50" sourceRef="Gateway_0pj5fa2" targetRef="EndEvent_ProcessComplete" />
    <exclusiveGateway id="ExclusiveGateway_SupplierIDCheck" name="Is &#39;PARTN&#39; Missing or error?">
      <incoming>SequenceFlow_CheckGateway</incoming>
      <outgoing>SequenceFlow_SupplierIDMissing</outgoing>
      <outgoing>SequenceFlow_SupplierIDPresent</outgoing>
    </exclusiveGateway>
    <sequenceFlow id="Flow_1wi6s78" sourceRef="Activity_0iqk13w" targetRef="ServiceTask_GetSupplierID_9876543" />
    <task id="Activity_0iqk13w" name="Get the &#39;BELNR&#39; from the Idoc">
      <incoming>SequenceFlow_SupplierIDMissing</incoming>
      <outgoing>Flow_1wi6s78</outgoing>
    </task>
    <task id="ServiceTask_GetSupplierID_9876543" name="Fetch Supplier ID for IDoc 9876543">
      <extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="function">GET_SUPPLIER_DATA</camunda:inputParameter>
          <camunda:inputParameter name="rfc_parameters">
            {"ORDER_NUMBER": "9876543"}
          </camunda:inputParameter>
        </camunda:inputOutput>
      </extensionElements>
      <incoming>Flow_1wi6s78</incoming>
      <outgoing>SequenceFlow_UpdateIDoc</outgoing>
    </task>
    <task id="ServiceTask_UpdateIDoc_9876543" name="Update IDoc 9876543 with Correct Supplier ID">
      <extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="idoc_id">9876543</camunda:inputParameter>
          <camunda:inputParameter name="segment">E1EDKA1</camunda:inputParameter>
          <camunda:inputParameter name="key">SUPPLIER_ID</camunda:inputParameter>
          <camunda:inputParameter name="value">#resultValue</camunda:inputParameter>
        </camunda:inputOutput>
      </extensionElements>
      <incoming>SequenceFlow_UpdateIDoc</incoming>
      <outgoing>SequenceFlow_ReinitializeIDoc</outgoing>
    </task>
    <task id="ServiceTask_ReinitializeIDoc_9876543" name="Reinitialize IDoc 9876543">
      <extensionElements>
        <camunda:inputOutput>
          <camunda:inputParameter name="idoc_id">9876543</camunda:inputParameter>
        </camunda:inputOutput>
      </extensionElements>
      <incoming>SequenceFlow_ReinitializeIDoc</incoming>
      <outgoing>Flow_1ylona2</outgoing>
    </task>
    <exclusiveGateway id="Gateway_0pj5fa2">
      <incoming>Flow_1ylona2</incoming>
      <incoming>SequenceFlow_SupplierIDPresent</incoming>
      <outgoing>Flow_0j9jc50</outgoing>
    </exclusiveGateway>
    <endEvent id="EndEvent_ProcessComplete">
      <incoming>Flow_0j9jc50</incoming>
    </endEvent>
    <association id="Association_1mbdqfh" associationDirection="None" sourceRef="ServiceTask_GetSupplierID_9876543" targetRef="TextAnnotation_1u11gvb" />
  </process>
  <bpmndi:BPMNDiagram id="BPMNDiagram_IdocExample">
    <bpmndi:BPMNPlane id="BPMNPlane_IdocExample" bpmnElement="Collaboration_1b9mwkl">
      <bpmndi:BPMNShape id="Participant_18ipkdm_di" bpmnElement="Participant_18ipkdm" isHorizontal="true">
        <omgdc:Bounds x="160" y="80" width="1070" height="340" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_StartEvent_IdocCheck" bpmnElement="StartEvent_IdocCheck">
        <omgdc:Bounds x="240" y="240" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="216" y="276" width="84" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1fq9pxy_di" bpmnElement="ServiceTask_CheckSupplierID_9876543">
        <omgdc:Bounds x="330" y="220" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_ExclusiveGateway_SupplierIDCheck" bpmnElement="ExclusiveGateway_SupplierIDCheck" isMarkerVisible="true">
        <omgdc:Bounds x="455" y="235" width="50" height="50" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="438" y="206" width="83" height="27" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0iqk13w_di" bpmnElement="Activity_0iqk13w">
        <omgdc:Bounds x="530" y="220" width="100" height="80" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1jcb3qz_di" bpmnElement="ServiceTask_GetSupplierID_9876543">
        <omgdc:Bounds x="660" y="222" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_0ls2rpp_di" bpmnElement="ServiceTask_UpdateIDoc_9876543">
        <omgdc:Bounds x="790" y="222" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Activity_1cq23ae_di" bpmnElement="ServiceTask_ReinitializeIDoc_9876543">
        <omgdc:Bounds x="920" y="222" width="100" height="80" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Gateway_0pj5fa2_di" bpmnElement="Gateway_0pj5fa2" isMarkerVisible="true">
        <omgdc:Bounds x="1045" y="237" width="50" height="50" />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="Shape_EndEvent_ProcessComplete" bpmnElement="EndEvent_ProcessComplete">
        <omgdc:Bounds x="1142" y="244" width="36" height="36" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="1115" y="280" width="90" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Edge_SequenceFlow_CheckGateway" bpmnElement="SequenceFlow_CheckGateway">
        <omgdi:waypoint x="430" y="260" />
        <omgdi:waypoint x="455" y="260" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Edge_SequenceFlow_SupplierIDMissing" bpmnElement="SequenceFlow_SupplierIDMissing">
        <omgdi:waypoint x="505" y="260" />
        <omgdi:waypoint x="530" y="260" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="500" y="243" width="18" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Edge_SequenceFlow_SupplierIDPresent" bpmnElement="SequenceFlow_SupplierIDPresent">
        <omgdi:waypoint x="480" y="285" />
        <omgdi:waypoint x="480" y="390" />
        <omgdi:waypoint x="1070" y="390" />
        <omgdi:waypoint x="1070" y="287" />
        <bpmndi:BPMNLabel>
          <omgdc:Bounds x="769" y="372" width="13" height="14" />
        </bpmndi:BPMNLabel>
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Edge_SequenceFlow_IdocCheck1" bpmnElement="SequenceFlow_IdocCheck1">
        <omgdi:waypoint x="276" y="260" />
        <omgdi:waypoint x="330" y="260" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Edge_SequenceFlow_UpdateIDoc" bpmnElement="SequenceFlow_UpdateIDoc">
        <omgdi:waypoint x="760" y="262" />
        <omgdi:waypoint x="790" y="262" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Edge_SequenceFlow_ReinitializeIDoc" bpmnElement="SequenceFlow_ReinitializeIDoc">
        <omgdi:waypoint x="890" y="262" />
        <omgdi:waypoint x="920" y="262" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1ylona2_di" bpmnElement="Flow_1ylona2">
        <omgdi:waypoint x="1020" y="262" />
        <omgdi:waypoint x="1045" y="262" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_0j9jc50_di" bpmnElement="Flow_0j9jc50">
        <omgdi:waypoint x="1095" y="262" />
        <omgdi:waypoint x="1142" y="262" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Flow_1wi6s78_di" bpmnElement="Flow_1wi6s78">
        <omgdi:waypoint x="630" y="261" />
        <omgdi:waypoint x="660" y="261" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_1mbdqfh_di" bpmnElement="Association_1mbdqfh">
        <omgdi:waypoint x="692" y="222" />
        <omgdi:waypoint x="685" y="208" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNShape id="TextAnnotation_0obj7se_di" bpmnElement="TextAnnotation_0obj7se">
        <omgdc:Bounds x="270" y="330" width="130" height="30" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_1u11gvb_di" bpmnElement="TextAnnotation_1u11gvb">
        <omgdc:Bounds x="610" y="110" width="340" height="98" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNShape id="TextAnnotation_1savs70_di" bpmnElement="TextAnnotation_1savs70">
        <omgdc:Bounds x="560" y="330" width="130" height="30" />
        <bpmndi:BPMNLabel />
      </bpmndi:BPMNShape>
      <bpmndi:BPMNEdge id="Association_0fc4w4a_di" bpmnElement="Association_0fc4w4a">
        <omgdi:waypoint x="352" y="300" />
        <omgdi:waypoint x="331" y="330" />
      </bpmndi:BPMNEdge>
      <bpmndi:BPMNEdge id="Association_1wppsmx_di" bpmnElement="Association_1wppsmx">
        <omgdi:waypoint x="594" y="300" />
        <omgdi:waypoint x="605" y="330" />
      </bpmndi:BPMNEdge>
    </bpmndi:BPMNPlane>
  </bpmndi:BPMNDiagram>
</definitions>
