1. Check the current date.

2. Get the IDoc date at segment EDI_DC40 and field CREDAT.

3. Analyze the two dates.

4. If the current date is the start of the month and the IDoc date is the last day of the previous month:
   - Send an email to error.handler2@company.com with the following content:
     ```
     Error Message:
     IDoc ID: <idoc_id>
     Pollex ID: <pollex_id>
     Description: G/L account <gl_account_id> is blocked for posting in company code <company_code>
     Please unblock the G/L account with ID <gl_account_id> for this period to complete the IDoc above.
     ```

5. Else:
   - Send a clarification email for the error to error.handler1@company.com with the following content:
     ```
     Error Message:
     IDoc ID: <idoc_id>
     Pollex ID: <pollex_id>
     Description: G/L account <gl_account_id> is blocked for posting in company code <company_code>
     Please provide clarification, as this is not a period error.
     ```